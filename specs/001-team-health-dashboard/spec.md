# 機能仕様書: チーム健全性ダッシュボード

**機能ブランチ**: `001-team-health-dashboard`
**作成日**: 2026-01-23
**ステータス**: ドラフト
**入力**: 開発研修におけるチームの健全性を可視化するダッシュボード

## 概要

大学1年生向け開発研修において、チームの開発健全性を客観的なデータで可視化し、レトロスペクティブでの改善サイクルを促進するためのダッシュボード。GitHub連携により、Issue/PRのデータを自動収集し、3つの評価軸でチームの状態を5段階評価する。

### ターゲットユーザー

- **メンター（本松さん）**: チーム全体の健全性を俯瞰し、レトロで客観的データを提示したい
- **開発研修生（大学1年生）**: 自分の現在地を知り、改善点を明確にしたい

### 解決したい課題

- 口頭での問題点列挙では改善されにくい
- 客観的データがないため、学生に納得感を持って行動変容を促せない
- issueの書き方が不十分な学生は実装で詰まりやすい

## ユーザーシナリオ & テスト *(必須)*

### ユーザーストーリー 1 - GitHub連携とリポジトリ登録 (優先度: P1)

メンターとして、評価対象のGitHubリポジトリを登録し、Issue/PRデータを取得できるようにしたい。

**この優先度の理由**: データ取得がなければ他の機能が動作しないため、最も基本的な機能

**独立テスト**: GitHubリポジトリURLを入力し、Issue/PRの一覧が取得・表示されることを確認

**受け入れシナリオ**:

1. **Given** ダッシュボードにログインしている状態, **When** GitHubリポジトリURLを入力して登録ボタンを押す, **Then** リポジトリが登録され、Issue/PRデータの取得が開始される
2. **Given** リポジトリが登録されている状態, **When** データ取得が完了する, **Then** 取得したIssue数とPR数が画面に表示される
3. **Given** 無効なリポジトリURLを入力した状態, **When** 登録ボタンを押す, **Then** エラーメッセージが表示され、登録されない

---

### ユーザーストーリー 2 - Issue完了速度の評価表示 (優先度: P2)

メンターとして、各Issueがオープンからクローズまでにかかった時間を5段階評価で確認したい。評価基準は設定ファイルで一元管理され、柔軟に変更可能であること。

**この優先度の理由**: 3つの評価軸の中で最も計測ロジックが明確で、すぐに価値を提供できる

**独立テスト**: 登録済みリポジトリのIssue一覧で、各Issueの完了時間と評価ランクが表示されることを確認

**前提条件**: 評価基準（時間の閾値、点数、メッセージ）が設定ファイルに定義されていること

**受け入れシナリオ**:

1. **Given** リポジトリにクローズ済みIssueが存在する状態, **When** ダッシュボードを表示する, **Then** 各Issueの完了時間と評価（S/A/B/C）が設定ファイルの基準に従って表示される
2. **Given** 設定ファイルで24時間以内がS評価と定義されている状態, **When** 24時間以内にクローズされたIssueの評価を確認する, **Then** S評価（120点/爆速）と表示される
3. **Given** 設定ファイルで1週間以上がC評価と定義されている状態, **When** 1週間以上クローズされていないIssueの評価を確認する, **Then** C評価（40点/停滞）と設定ファイルに定義されたメッセージが表示される
4. **Given** 設定ファイルの評価基準を変更した状態, **When** ダッシュボードを再表示する, **Then** 新しい基準で評価が再計算される

---

### ユーザーストーリー 3 - Issue記述品質のAI評価 (優先度: P3)

メンターとして、各Issueの記述内容が構造的かどうかをAIで評価し、改善ポイントを把握したい。

**この優先度の理由**: AI評価のプロンプト設計と安定性確保に時間がかかるが、教育効果が高い

**独立テスト**: Issueの内容をAIが分析し、評価点と具体的な改善フィードバックが表示されることを確認

**受け入れシナリオ**:

1. **Given** Issueが存在する状態, **When** AI評価を実行する, **Then** 5段階評価と評価理由が表示される
2. **Given** ユーザーストーリーが記載されていないIssueがある状態, **When** AI評価を確認する, **Then** 「ユーザーストーリーがありません」という具体的なフィードバックが表示される
3. **Given** すべての評価項目（ユーザーストーリー、実装方針、懸念点、assign）が揃っているIssueがある状態, **When** AI評価を確認する, **Then** 高評価（4-5点）が付与される

---

### ユーザーストーリー 4 - Issue-PR整合性チェック (優先度: P4)

メンターとして、IssueとそれにリンクされたPRの内容が整合しているかを確認したい。

**この優先度の理由**: Issue品質評価の延長線上にあり、より高度な分析が必要

**独立テスト**: IssueとリンクされたPRの内容を比較し、整合性評価が表示されることを確認

**受け入れシナリオ**:

1. **Given** IssueにリンクされたPRが存在する状態, **When** 整合性チェックを実行する, **Then** 整合性スコアと分析結果が表示される
2. **Given** PRにIssueの範囲外の変更が含まれている状態, **When** 整合性チェックを確認する, **Then** 「Issueの分割を検討してください」という改善提案が表示される

---

### ユーザーストーリー 5 - チーム全体サマリーダッシュボード (優先度: P5)

メンターとして、チーム全体の健全性サマリーをレトロスペクティブで共有したい。

**この優先度の理由**: 個別評価が揃った後に、集計・可視化機能として提供

**独立テスト**: チーム全体の平均スコア、トレンド、改善が必要な領域が一覧で表示されることを確認

**受け入れシナリオ**:

1. **Given** 複数のIssue/PRが評価済みの状態, **When** サマリーダッシュボードを表示する, **Then** チーム全体の3軸平均スコアが表示される
2. **Given** スプリント期間が設定されている状態, **When** サマリーを確認する, **Then** 前スプリントとの比較グラフが表示される

---

### エッジケース

- リポジトリにIssueが1件もない場合 → 「まだIssueがありません」と表示
- PRがIssueにリンクされていない場合 → 整合性チェックをスキップし、「PRをリンクしてください」と案内
- GitHubのAPI制限に達した場合 → エラーを表示し、次回取得可能時刻を案内
- Issue作成後、一度もステータス変更されていない場合 → 「着手待ち」として区別

## 要件 *(必須)*

### 機能要件

- **FR-001**: システムはGitHubリポジトリのURL入力により、リポジトリを登録できなければならない
- **FR-002**: システムはGitHub APIを通じてIssue/PRデータを取得できなければならない
- **FR-003**: システムはIssueのオープンからクローズまでの時間を計算し、5段階評価を付与しなければならない
- **FR-004**: システムはIssueの記述内容をAIで分析し、構造品質を5段階評価しなければならない
- **FR-005**: システムはIssueとPRの整合性をAIで分析し、評価を付与しなければならない
- **FR-006**: システムはチーム全体のサマリーを集計・表示できなければならない
- **FR-007**: 評価基準（点数の境界値、メッセージなど）は設定ファイルで管理しなければならない
- **FR-008**: AI連携部分は抽象化レイヤーを介して実装しなければならない

### 評価基準（設定ファイルで管理）

**Issue完了速度の評価基準**:

| 時間 | 点数 | 評価 | メッセージ |
|------|------|------|-----------|
| 24時間以内 | 120点 | S（爆速） | 小さな単位で開発できています！素晴らしい。 |
| 1〜3日 | 100点 | A（理想的） | 非常に健全な開発スピードです。 |
| 4〜5日 | 70点 | B（注意） | 少しタスクが肥大化しているかも？分担を検討。 |
| 1週間以上 | 40点 | C（停滞） | 何か詰まっているはず。メンターに相談しよう。 |

**Issue記述品質の評価項目**:
- ユーザーストーリーの有無と質
- 実装方針の記載
- 懸念点の記載
- assigneeの設定

### 主要エンティティ

- **リポジトリ**: GitHub URL、名前、オーナー、最終同期日時
- **Issue**: Issue番号、タイトル、本文、ステータス、作成日時、クローズ日時、assignee、完了時間評価、記述品質評価
- **プルリクエスト**: PR番号、タイトル、本文、リンクされたIssue、整合性評価
- **評価設定**: 評価軸ID、境界値、点数、メッセージ
- **評価結果**: 対象ID、評価軸、点数、評価ランク、フィードバックメッセージ

## 成功基準 *(必須)*

### 測定可能な成果

- **SC-001**: メンターがリポジトリ登録から評価表示まで5分以内に完了できる
- **SC-002**: Issue完了速度の評価が100%正確に算出される（手動計算と一致）
- **SC-003**: AI評価の結果が同一Issueに対して80%以上の再現性を持つ
- **SC-004**: レトロスペクティブでダッシュボードを使用した際、参加者の80%が「改善点が明確になった」と回答
- **SC-005**: 研修生がダッシュボードを見て、30秒以内に自分の評価を理解できる

## 前提条件

- GitHubリポジトリはパブリック、またはアクセストークンでアクセス可能
- 研修チームはGitHub Issueを使ったタスク管理を行っている
- AI評価にはOpenAI API（または同等のLLM API）を使用
- 評価はあくまでチーム改善のためのツールであり、成績評価には直結しない
